/*! caja-kissy 2013-08-28 */
KISSY.add("openjs/thirdparty/globalservice/1.0/index",function(t){function n(n){var o={};return o.addListener=function(t,n){o.addListener.Fncs[t]||(o.addListener.Fncs[t]=[]),o.addListener.Fncs[t].push(n)},o.addListener.Fncs=[],function(){r.on(window,"scroll",function(){var e={scrollTop:t.DOM.scrollTop(window)};n.markReadOnlyRecord(e);var r=n.tame(e);if(o.addListener.Fncs.windowScroll)for(var i=0;o.addListener.Fncs.windowScroll.length>i;i++)o.addListener.Fncs.windowScroll[i](r)})}(),function(){function t(t,n){var r=e.create("<iframe id=''"+i+"' name='"+i+"'></iframe>");e.css(r,"display","none");var o=e.create('<form action="'+t+'" target="'+i+'" method="post"  enctype="multipart/form-data"></form>');e.css(r,"display","none");var a=e.create('<input type="hidden" name="token" value="'+n+'"/>');return o.appendChild(a),{form:o,iframe:r}}var i="tempCajaIframe";r.delegate(document,"change","input.J_TCajaUploadImg",function(i){var a=i.target,s=t(e.attr(a,"data-url"),1);e.append(a,s.form),document.body.appendChild(s.iframe),document.body.appendChild(s.form),s.form.submit();var u=function(t){if(o.addListener.Fncs.cajaupload)for(var n=0;o.addListener.Fncs.cajaupload.length>n;n++)o.addListener.Fncs.cajaupload[n](t)};r.on(window,"cajaupload",function(t){t={content:t.content},n.markReadOnlyRecord(t);var o=n.tame(t);u(o),r.remove(window,"cajaupload"),e.remove(s.iframe),e.remove(s.form)})})}(),function(){return o=n.markReadOnlyRecord(o),n.markFunction(o.addListener),{GS:n.tame(o),kissy:!1}}}var e=t.DOM,r=t.Event;return n});